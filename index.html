<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Scroll-Triggered Audio (Scroll-Position)</title>
  <style>
    html, body { margin:0; padding:0; }
    #startStop {
      position: fixed; top:10px; left:10px; z-index:100;
      padding:8px 12px; font-size:16px;
    }
    section {
      height:100vh;
      display:flex; justify-content:center; align-items:center;
      font-size:2rem;
    }
    section[data-track="rain"]  { background:#e0f7fa; }
    section[data-track="piano"] { background:#ffe0b2; }
    section[data-track="kids"]  { background:#c8e6c9; }
  </style>
</head>
<body>
  <button id="startStop">Start Audio</button>

  <audio id="rain"  src="rain.mp3"          preload="auto" loop></audio>
  <audio id="piano" src="piano.mp3"         preload="auto" loop></audio>
  <audio id="kids"  src="kids_playing.mp3"  preload="auto" loop></audio>

  <section data-track="rain">Rain Sound</section>
  <section data-track="piano">Piano Sound</section>
  <section data-track="kids">Kids Playing</section>

  <script>
    const btn     = document.getElementById('startStop');
    const audios  = {};        // will hold { el, started }
    let   baseH   = 0;

    function onScroll() {
      const y = window.scrollY;
      // Section 1: any scroll > 0
      if (!audios.rain.started && y > 0) {
        audios.rain.el.volume = 0.5;
        audios.rain.started = true;
      }
      // Section 2: y >= baseH * 1
      if (!audios.piano.started && y >= baseH * 1) {
        audios.piano.el.volume = 0.5;
        audios.piano.started = true;
      }
      // Section 3: y >= baseH * 2
      if (!audios.kids.started && y >= baseH * 2) {
        audios.kids.el.volume = 0.5;
        audios.kids.started = true;
      }
    }

    btn.addEventListener('click', () => {
      if (btn.dataset.running) {
        // Stop & reset
        window.removeEventListener('scroll', onScroll);
        Object.values(audios).forEach(a => {
          a.el.pause();
          a.el.currentTime = 0;
          a.el.volume = 0;
          a.started = false;
        });
        btn.textContent = 'Start Audio';
        delete btn.dataset.running;
      } else {
        // Start
        btn.dataset.running = 'true';
        btn.textContent = 'Stop Audio';

        // Capture viewport height once
        baseH = window.innerHeight;

        // Play & mute all layers
        ['rain','piano','kids'].forEach(id => {
          const el = document.getElementById(id);
          el.volume = 0;
          el.play().catch(()=>{}); // unlock on mobile
          audios[id] = { el, started: false };
        });

        // Listen for scroll
        window.addEventListener('scroll', onScroll, { passive: true });
      }
    });
  </script>
</body>
</html>
